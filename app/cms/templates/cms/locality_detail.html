{% extends "base_generic.html" %}
{% load user_tags %}

{% block title %}Locality {{ locality.abbreviation }}{% endblock %}

{% block content %}
    

        <div class="template-detail-container">
            <div class="template-detail-header">
                <h2 class="template-detail-h2">Locality Detail</h2>
                {% if user.is_superuser or user|has_group:"Collection Managers" %}
                <a href="{% url 'locality_edit' locality.pk %}" class="edit-icon">
                    Edit Form ✏️
                </a>
                {% endif %}
            </div>
            <div class="grid-container">
                <!-- Field Number Card -->
                <div class="card">
                    <p><strong>Abbreviation: </strong> <br> {{ locality.abbreviation }}</p>
                                     
                </div>
    
                <!-- Verbatim Taxon Card -->
                <div class="card">
                    <p><strong>Name:</strong> <br> {{ locality.name }} </p>
                </div>

                <div class="cards">
                    <table class="w3-table-all w3-hoverable">
                        <caption class="w3-large"><strong>Accession details</strong></caption>
                        <thead>
                            <tr>
                                <th>Collection</th>
                                <th>Specimen Prefix</th>
                                <th>Specimen Number</th>
                                <th>Taxon</th>
                                <th>Element</th>
                                {% if user.is_superuser or user|has_group:"Collection Managers" %}
                                <th>Accessioned by</th>
                                {% endif %}
                            </tr>
                        </thead>
                        <tbody>
                            {% for accession in accessions %}
                            <tr>
                                <td>{{ accession.collection.abbreviation }}</td>
                                <td>{{ accession.specimen_prefix.abbreviation }}</td>
                                <td><a href="{% url 'accession_detail' accession.pk %}">{{ accession.specimen_no }}</a></td>
                                <td>
                                    {% if accession.taxa_list %}
                                        {{ accession.taxa_list|join:", " }}
                                    {% else %}
                                        &mdash;
                                    {% endif %}
                                </td>
                                <td>
                                    {% if accession.element_list %}
                                        {{ accession.element_list|join:", " }}
                                    {% else %}
                                        &mdash;
                                    {% endif %}
                                </td>
                                {% if user.is_superuser or user|has_group:"Collection Managers" %}
                                <td>{{ accession.accessioned_by }}</td>
                                {% endif %}
                            </tr>
                            {% empty %}
                            <tr>
                                <td colspan="{% if user.is_superuser or user|has_group:"Collection Managers" %}6{% else %}5{% endif %}" class="w3-center">No accessions found.</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>

            </div>
        </div>

{% endblock %}


