{% extends "admin/base_site.html" %}

{% block content %}
  <h1>Process pending scans</h1>
  <p>There are <strong>{{ pending_total }}</strong> scans awaiting OCR.</p>

  <form method="post" class="ocr-limit-form">
    {% csrf_token %}
    <fieldset>
      <legend>Select how many scans to process</legend>
      {% if selection_error %}
        <p class="errorlist"><strong>{{ selection_error }}</strong></p>
      {% endif %}
      <ul class="option-list">
        <li>
          <label>
            <input type="radio" name="scan_limit" value="all"
                   {% if not selected_choice or selected_choice == "all" %}checked{% endif %}
                   {% if pending_total == 0 %}disabled{% endif %}>
            Process all pending scans ({{ pending_total }})
          </label>
        </li>
        {% for option in limit_options %}
          <li>
            <label>
              <input type="radio" name="scan_limit" value="{{ option }}"
                     {% if selected_choice == option|stringformat:"s" %}checked{% endif %}
                     {% if pending_total == 0 %}disabled{% endif %}>
              Process {{ option }} scans
            </label>
          </li>
        {% endfor %}
      </ul>
      <div class="form-actions">
        <button type="submit" class="default" {% if pending_total == 0 %}disabled{% endif %}>Start processing</button>
        <a href="{% url 'admin:index' %}" class="button">Cancel</a>
      </div>
    </fieldset>
  </form>

  <style>
    .ocr-limit-form fieldset {
      border: 1px solid #ddd;
      padding: 1.5rem;
      background-color: #fff;
      max-width: 480px;
    }

    .ocr-limit-form .option-list {
      list-style: none;
      margin: 1rem 0;
      padding: 0;
      display: grid;
      gap: 0.5rem;
    }

    .ocr-limit-form label {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .ocr-limit-form .form-actions {
      display: flex;
      gap: 0.75rem;
      margin-top: 1.5rem;
    }

    .ocr-limit-form .errorlist {
      color: #a30000;
      margin: 0 0 0.75rem 0;
    }
  </style>
{% endblock %}
